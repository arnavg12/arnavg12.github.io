<!DOCTYPE html>
<html>
<head>
    <title>Project 3A</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 40px 10%;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }

        .text-block {
            text-align: left;
            margin-bottom: 20px;
        }

        h1 {
            font-weight: 600;
            margin-bottom: 10px;
        }

        p.description {
            font-size: 16px;
            color: #444;
            margin: 0;
        }

        .image-row {
            display: flex;
            gap: 50px;
            width: 100%;
            margin-bottom: 20px;
        }

        figure {
            margin: 0;
            display: flex;
            flex-direction: column;
        }

        img {
            width: 100%;
            object-fit: contain;
        }

        .chess1 {
            height: 343px;
        }

        .chess2 {
            height: 497px;
        }

        .recover1 {
            height: 466px;
        }

        .guernica1 {
            height: 394.5px;
        }

        figcaption {
            margin-top: 4px;
            text-align: center;
            font-size: 16px;
            color: #333;
        }

        .caption-line {
            margin: 2px 0;
        }

        .section-spacing {
            margin-top: 60px;
        }

        .gold {
            height: 466px;
        }

        .book {
            height: 600px;
        }

    </style>
</head>
<body>

    <div class="content section-spacing">
        <div class="text-block">
            <h1>Project 3A</h1>
            <p class="description">
                In this project, we create mosaics from images by manually selecting correspondences, recovering homographies, warping images accordingly, and blending them together.
            </p>
        </div>
    </div>

    <div class="content section-spacing">
        <div class="text-block">
            <h1>Shoot the Pictures</h1>
            <p class="description">
                The first part of the project involved capturing the images that would be used to create mosaics. Below are three sets of images we took.
            </p>
        </div>

        <div class="image-row">
            <figure>
                <img src="etch4.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Etcheverry 1</div>
                </figcaption>
            </figure>

            <figure>
                <img src="etch3.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Etcheverry 2</div>
                </figcaption>
            </figure>
            <figure>
                <img src="etch2.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Etcheverry 3</div>
                </figcaption>
            </figure>
            <figure>
                <img src="etch1.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Etcheverry 4</div>
                </figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="gold1.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Goldman 1</div>
                </figcaption>
            </figure>

            <figure>
                <img src="gold2.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Goldman 2</div>
                </figcaption>
            </figure>
            <figure>
                <img src="gold3.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Goldman 3</div>
                </figcaption>
            </figure>
            <figure>
                <img src="gold4.jpg" alt="guernica" class = "chess1">
                <figcaption>
                    <div class="caption-line">Goldman 4</div>
                </figcaption>
            </figure>
        </div>
        <div class="image-row">
            <figure>
                <img src="books1.jpg" alt="guernica" class = "">
                <figcaption>
                    <div class="caption-line">Bookshelf 1</div>
                </figcaption>
            </figure>

            <figure>
                <img src="books2.jpg" alt="guernica" class = "">
                <figcaption>
                    <div class="caption-line">Bookshelf 2</div>
                </figcaption>
            </figure>
            <figure>
                <img src="books3.jpg" alt="guernica" class = "">
                <figcaption>
                    <div class="caption-line">Bookshelf 3</div>
                </figcaption>
            </figure>
            <figure>
                <img src="books4.jpg" alt="guernica" class = "">
                <figcaption>
                    <div class="caption-line">Bookshelf 4</div>
                </figcaption>
            </figure>
        </div>

    </div>

    <div class="content section-spacing">
        <div class="text-block">
            <h1>Recover Homographies</h1>
            <p class="description">
                In this section, we recovered a 3√ó3 homography matrix 
                ùêª from two sets of corresponding points (at least four correspondences). Using the homography equation 
                ùëù‚Ä≤=ùêªùëù, we derived a system of linear equations for the eight unknowns in 
                ùêª (with the bottom-right entry set to 1) and solved it using least squares to handle overdetermined systems and reduce noise sensitivity.
                To collect correspondences, we implemented a simple point selection UI using Matplotlib, allowing users to interactively select matching points between two images or multiple points within a single image.
                The derivation of the system and the process of recovering homographies from correspondences in two sample images are shown below.
             </p>
        </div>

        <div class="image-row">
            <figure>
                <img src="calculations.jpg" alt="calculations" class = "recover1">
                <figcaption>
                    <div class="caption-line">System of Equations Derivation</div>
                </figcaption>
            </figure>

            <figure>
                <img src="correspondences.jpg" alt="correspondences" class = "recover1">
                <figcaption>
                    <div class="caption-line">Selecting Point Correspondences</div>
                </figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="points.jpg" alt="points">
                <figcaption>
                    <div class="caption-line">Point Correspondences</div>
                </figcaption>
            </figure>

            <figure>
                <img src="systems.jpg" alt="systems">
                <figcaption>
                    <div class="caption-line">System of Equations</div>
                </figcaption>
            </figure>

            <figure>
                <img src="homography.jpg" alt="homography">
                <figcaption>
                    <div class="caption-line">Computed Homography</div>
                </figcaption>
            </figure>
        </div>
    </div>

    <div class="content section-spacing">
        <div class="text-block">
            <h1>Warp the Images</h1>
            <p class="description">
                In this section, we implemented inverse image warping using two interpolation methods: nearest neighbor and bilinear. We first determined the output bounding box by projecting the corners of the input image using the homography. Then for each pixel in the output, we applied the inverse homography to find the corresponding location in the source image and interpolated its pixel value using either nearest neighbor or bilinear interpolation. For nearest neighbor, we rounded the location coordinates to the nearest pixel, while for bilinear interpolation, we computed a weighted average of the four neighboring pixel values. 
            </p><p>
                Comparing the two methods, nearest neighbor was simpler to implement and had faster runtime (e.g., for Guernica, nearest neighbor took 2.42 s while bilinear took 4.22 s). However, nearest neighbor often produced blocky edges and aliasing, whereas bilinear interpolation resulted in smoother transitions (see the chessboard edges for comparison). To verify correctness, we applied the implementations in this section and the last one to rectify two images with known planar geometry: the chess match between Hikaru and Magnus, where we mapped the chessboard corners to a predefined square, and Picasso‚Äôs Guernica, where we used the painting‚Äôs actual dimensions as target points. The original, cropped, and rectified images using both interpolation methods are shown below:
            </p>
        </div>

        <div class="image-row">
            <figure>
                <img src="chess.jpg" alt="chess" class = "chess1">
                <figcaption>
                    <div class="caption-line">Original Chess</div>
                </figcaption>
            </figure>

            <figure>
                <img src="chess_crop.jpg" alt="chess" class = "chess1">
                <figcaption>
                    <div class="caption-line">Cropped Chess</div>
                </figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="chess_nn.jpg" alt="chess" class = "chess2">
                <figcaption>
                    <div class="caption-line">Rectified Chess (Nearest Neighbor)</div>
                </figcaption>
            </figure>

            <figure>
                <img src="chess_bilinear.jpg" alt="chess" class = "chess2">
                <figcaption>
                    <div class="caption-line">Rectified Chess (Bilinear)</div>
                </figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="guernica.jpg" alt="guernica" class = "guernica1">
                <figcaption>
                    <div class="caption-line">Original Guernica</div>
                </figcaption>
            </figure>

            <figure>
                <img src="guernica_crop.jpg" alt="guernica" class = "guernica1">
                <figcaption>
                    <div class="caption-line">Cropped Guernica</div>
                </figcaption>
            </figure>
        </div>

        <div class="image-row">
            <figure>
                <img src="guernica_nn.jpg" alt="guernica" class = "guernica2">
                <figcaption>
                    <div class="caption-line">Rectified Guernica (Nearest Neighbor)</div>
                </figcaption>
            </figure>

            <figure>
                <img src="guernica_bilinear.jpg" alt="guernica" class = "guernica2">
                <figcaption>
                    <div class="caption-line">Rectified Guernica (Bilinear)</div>
                </figcaption>
            </figure>
        </div>
    </div>

    <div class="content section-spacing">
        <div class="text-block">
            <h1>Blend the Images into a Mosaic</h1>
            <p class="description">
                In this section, we combined warped images to create mosaics. We selected one image as the base and added the other images one by one. For each new image, we computed its homography relative to the base image and used it to warp the image into the mosaic. The mosaic canvas was expanded as needed to accommodate each new warped image. To blend the images and reduce edge artifacts, we used an alpha channel to perform weighted averaging at every pixel. The alpha was set to 1 at the center of each warped image and decreased linearly to 0 at the edges using distance_transform_edt. By continuously applying this process, we gradually built up the complete mosaic.
                Below, we show the mosaic process applied to three sets of images. Despite using alpha blending, some brightness differences and minor misalignments are visible, though the overall mosaic quality remains good.
        </div>

        <div class="image-row">
            <figure>
                <img src="gold.jpg" alt="gold" class = "gold">
                <figcaption>
                    <div class="caption-line">Goldman Mosaic</div>
                </figcaption>
            </figure>
            <figure>
                <img src="etch.jpg" alt="etch" class = "gold">
                <figcaption>
                    <div class="caption-line">Etcheverry Mosaic</div>
                </figcaption>
            </figure>
        </div>
        <div class="image-row">
            <figure>
                <img src="books.jpg" alt="gold" class = "book">
                <figcaption>
                    <div class="caption-line">Bookshelf Mosaic</div>
                </figcaption>
            </figure>
        </div>

    </div>

    </div>